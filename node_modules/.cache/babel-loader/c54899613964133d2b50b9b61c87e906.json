{"ast":null,"code":"\"use strict\";\n\nvar _classCallCheck = require(\"C:/Users/lenovo/letterBox/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"C:/Users/lenovo/letterBox/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _assert = require(\"assert\");\n\nvar t = require(\"@babel/types\");\n\nvar _importBuilder = require(\"./import-builder\");\n\nvar _isModule = require(\"./is-module\");\n\nvar ImportInjector = /*#__PURE__*/function () {\n  function ImportInjector(path, importedSource, opts) {\n    _classCallCheck(this, ImportInjector);\n\n    this._defaultOpts = {\n      importedSource: null,\n      importedType: \"commonjs\",\n      importedInterop: \"babel\",\n      importingInterop: \"babel\",\n      ensureLiveReference: false,\n      ensureNoContext: false,\n      importPosition: \"before\"\n    };\n    var programPath = path.find(function (p) {\n      return p.isProgram();\n    });\n    this._programPath = programPath;\n    this._programScope = programPath.scope;\n    this._hub = programPath.hub;\n    this._defaultOpts = this._applyDefaults(importedSource, opts, true);\n  }\n\n  _createClass(ImportInjector, [{\n    key: \"addDefault\",\n    value: function addDefault(importedSourceIn, opts) {\n      return this.addNamed(\"default\", importedSourceIn, opts);\n    }\n  }, {\n    key: \"addNamed\",\n    value: function addNamed(importName, importedSourceIn, opts) {\n      _assert(typeof importName === \"string\");\n\n      return this._generateImport(this._applyDefaults(importedSourceIn, opts), importName);\n    }\n  }, {\n    key: \"addNamespace\",\n    value: function addNamespace(importedSourceIn, opts) {\n      return this._generateImport(this._applyDefaults(importedSourceIn, opts), null);\n    }\n  }, {\n    key: \"addSideEffect\",\n    value: function addSideEffect(importedSourceIn, opts) {\n      return this._generateImport(this._applyDefaults(importedSourceIn, opts), false);\n    }\n  }, {\n    key: \"_applyDefaults\",\n    value: function _applyDefaults(importedSource, opts) {\n      var isInit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var optsList = [];\n\n      if (typeof importedSource === \"string\") {\n        optsList.push({\n          importedSource: importedSource\n        });\n        optsList.push(opts);\n      } else {\n        _assert(!opts, \"Unexpected secondary arguments.\");\n\n        optsList.push(importedSource);\n      }\n\n      var newOpts = Object.assign({}, this._defaultOpts);\n\n      var _loop = function _loop() {\n        var opts = _optsList[_i];\n        if (!opts) return \"continue\";\n        Object.keys(newOpts).forEach(function (key) {\n          if (opts[key] !== undefined) newOpts[key] = opts[key];\n        });\n\n        if (!isInit) {\n          if (opts.nameHint !== undefined) newOpts.nameHint = opts.nameHint;\n          if (opts.blockHoist !== undefined) newOpts.blockHoist = opts.blockHoist;\n        }\n      };\n\n      for (var _i = 0, _optsList = optsList; _i < _optsList.length; _i++) {\n        var _ret = _loop();\n\n        if (_ret === \"continue\") continue;\n      }\n\n      return newOpts;\n    }\n  }, {\n    key: \"_generateImport\",\n    value: function _generateImport(opts, importName) {\n      var isDefault = importName === \"default\";\n      var isNamed = !!importName && !isDefault;\n      var isNamespace = importName === null;\n      var importedSource = opts.importedSource,\n          importedType = opts.importedType,\n          importedInterop = opts.importedInterop,\n          importingInterop = opts.importingInterop,\n          ensureLiveReference = opts.ensureLiveReference,\n          ensureNoContext = opts.ensureNoContext,\n          nameHint = opts.nameHint,\n          importPosition = opts.importPosition,\n          blockHoist = opts.blockHoist;\n      var name = nameHint || importName;\n      var isMod = (0, _isModule.default)(this._programPath);\n      var isModuleForNode = isMod && importingInterop === \"node\";\n      var isModuleForBabel = isMod && importingInterop === \"babel\";\n\n      if (importPosition === \"after\" && !isMod) {\n        throw new Error(\"\\\"importPosition\\\": \\\"after\\\" is only supported in modules\");\n      }\n\n      var builder = new _importBuilder.default(importedSource, this._programScope, this._hub);\n\n      if (importedType === \"es6\") {\n        if (!isModuleForNode && !isModuleForBabel) {\n          throw new Error(\"Cannot import an ES6 module from CommonJS\");\n        }\n\n        builder.import();\n\n        if (isNamespace) {\n          builder.namespace(nameHint || importedSource);\n        } else if (isDefault || isNamed) {\n          builder.named(name, importName);\n        }\n      } else if (importedType !== \"commonjs\") {\n        throw new Error(\"Unexpected interopType \\\"\".concat(importedType, \"\\\"\"));\n      } else if (importedInterop === \"babel\") {\n        if (isModuleForNode) {\n          name = name !== \"default\" ? name : importedSource;\n          var es6Default = \"\".concat(importedSource, \"$es6Default\");\n          builder.import();\n\n          if (isNamespace) {\n            builder.default(es6Default).var(name || importedSource).wildcardInterop();\n          } else if (isDefault) {\n            if (ensureLiveReference) {\n              builder.default(es6Default).var(name || importedSource).defaultInterop().read(\"default\");\n            } else {\n              builder.default(es6Default).var(name).defaultInterop().prop(importName);\n            }\n          } else if (isNamed) {\n            builder.default(es6Default).read(importName);\n          }\n        } else if (isModuleForBabel) {\n          builder.import();\n\n          if (isNamespace) {\n            builder.namespace(name || importedSource);\n          } else if (isDefault || isNamed) {\n            builder.named(name, importName);\n          }\n        } else {\n          builder.require();\n\n          if (isNamespace) {\n            builder.var(name || importedSource).wildcardInterop();\n          } else if ((isDefault || isNamed) && ensureLiveReference) {\n            if (isDefault) {\n              name = name !== \"default\" ? name : importedSource;\n              builder.var(name).read(importName);\n              builder.defaultInterop();\n            } else {\n              builder.var(importedSource).read(importName);\n            }\n          } else if (isDefault) {\n            builder.var(name).defaultInterop().prop(importName);\n          } else if (isNamed) {\n            builder.var(name).prop(importName);\n          }\n        }\n      } else if (importedInterop === \"compiled\") {\n        if (isModuleForNode) {\n          builder.import();\n\n          if (isNamespace) {\n            builder.default(name || importedSource);\n          } else if (isDefault || isNamed) {\n            builder.default(importedSource).read(name);\n          }\n        } else if (isModuleForBabel) {\n          builder.import();\n\n          if (isNamespace) {\n            builder.namespace(name || importedSource);\n          } else if (isDefault || isNamed) {\n            builder.named(name, importName);\n          }\n        } else {\n          builder.require();\n\n          if (isNamespace) {\n            builder.var(name || importedSource);\n          } else if (isDefault || isNamed) {\n            if (ensureLiveReference) {\n              builder.var(importedSource).read(name);\n            } else {\n              builder.prop(importName).var(name);\n            }\n          }\n        }\n      } else if (importedInterop === \"uncompiled\") {\n        if (isDefault && ensureLiveReference) {\n          throw new Error(\"No live reference for commonjs default\");\n        }\n\n        if (isModuleForNode) {\n          builder.import();\n\n          if (isNamespace) {\n            builder.default(name || importedSource);\n          } else if (isDefault) {\n            builder.default(name);\n          } else if (isNamed) {\n            builder.default(importedSource).read(name);\n          }\n        } else if (isModuleForBabel) {\n          builder.import();\n\n          if (isNamespace) {\n            builder.default(name || importedSource);\n          } else if (isDefault) {\n            builder.default(name);\n          } else if (isNamed) {\n            builder.named(name, importName);\n          }\n        } else {\n          builder.require();\n\n          if (isNamespace) {\n            builder.var(name || importedSource);\n          } else if (isDefault) {\n            builder.var(name);\n          } else if (isNamed) {\n            if (ensureLiveReference) {\n              builder.var(importedSource).read(name);\n            } else {\n              builder.var(name).prop(importName);\n            }\n          }\n        }\n      } else {\n        throw new Error(\"Unknown importedInterop \\\"\".concat(importedInterop, \"\\\".\"));\n      }\n\n      var _builder$done = builder.done(),\n          statements = _builder$done.statements,\n          resultName = _builder$done.resultName;\n\n      this._insertStatements(statements, importPosition, blockHoist);\n\n      if ((isDefault || isNamed) && ensureNoContext && resultName.type !== \"Identifier\") {\n        return t.sequenceExpression([t.numericLiteral(0), resultName]);\n      }\n\n      return resultName;\n    }\n  }, {\n    key: \"_insertStatements\",\n    value: function _insertStatements(statements) {\n      var importPosition = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"before\";\n      var blockHoist = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 3;\n\n      var body = this._programPath.get(\"body\");\n\n      if (importPosition === \"after\") {\n        for (var i = body.length - 1; i >= 0; i--) {\n          if (body[i].isImportDeclaration()) {\n            body[i].insertAfter(statements);\n            return;\n          }\n        }\n      } else {\n        statements.forEach(function (node) {\n          node._blockHoist = blockHoist;\n        });\n        var targetPath = body.find(function (p) {\n          var val = p.node._blockHoist;\n          return Number.isFinite(val) && val < 4;\n        });\n\n        if (targetPath) {\n          targetPath.insertBefore(statements);\n          return;\n        }\n      }\n\n      this._programPath.unshiftContainer(\"body\", statements);\n    }\n  }]);\n\n  return ImportInjector;\n}();\n\nexports.default = ImportInjector;","map":{"version":3,"sources":["C:/Users/lenovo/letterBox/node_modules/@babel/helper-module-imports/lib/import-injector.js"],"names":["Object","defineProperty","exports","value","default","_assert","require","t","_importBuilder","_isModule","ImportInjector","path","importedSource","opts","_defaultOpts","importedType","importedInterop","importingInterop","ensureLiveReference","ensureNoContext","importPosition","programPath","find","p","isProgram","_programPath","_programScope","scope","_hub","hub","_applyDefaults","importedSourceIn","addNamed","importName","_generateImport","isInit","optsList","push","newOpts","assign","keys","forEach","key","undefined","nameHint","blockHoist","isDefault","isNamed","isNamespace","name","isMod","isModuleForNode","isModuleForBabel","Error","builder","import","namespace","named","es6Default","var","wildcardInterop","defaultInterop","read","prop","done","statements","resultName","_insertStatements","type","sequenceExpression","numericLiteral","body","get","i","length","isImportDeclaration","insertAfter","node","_blockHoist","targetPath","val","Number","isFinite","insertBefore","unshiftContainer"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _assert = require(\"assert\");\n\nvar t = require(\"@babel/types\");\n\nvar _importBuilder = require(\"./import-builder\");\n\nvar _isModule = require(\"./is-module\");\n\nclass ImportInjector {\n  constructor(path, importedSource, opts) {\n    this._defaultOpts = {\n      importedSource: null,\n      importedType: \"commonjs\",\n      importedInterop: \"babel\",\n      importingInterop: \"babel\",\n      ensureLiveReference: false,\n      ensureNoContext: false,\n      importPosition: \"before\"\n    };\n    const programPath = path.find(p => p.isProgram());\n    this._programPath = programPath;\n    this._programScope = programPath.scope;\n    this._hub = programPath.hub;\n    this._defaultOpts = this._applyDefaults(importedSource, opts, true);\n  }\n\n  addDefault(importedSourceIn, opts) {\n    return this.addNamed(\"default\", importedSourceIn, opts);\n  }\n\n  addNamed(importName, importedSourceIn, opts) {\n    _assert(typeof importName === \"string\");\n\n    return this._generateImport(this._applyDefaults(importedSourceIn, opts), importName);\n  }\n\n  addNamespace(importedSourceIn, opts) {\n    return this._generateImport(this._applyDefaults(importedSourceIn, opts), null);\n  }\n\n  addSideEffect(importedSourceIn, opts) {\n    return this._generateImport(this._applyDefaults(importedSourceIn, opts), false);\n  }\n\n  _applyDefaults(importedSource, opts, isInit = false) {\n    const optsList = [];\n\n    if (typeof importedSource === \"string\") {\n      optsList.push({\n        importedSource\n      });\n      optsList.push(opts);\n    } else {\n      _assert(!opts, \"Unexpected secondary arguments.\");\n\n      optsList.push(importedSource);\n    }\n\n    const newOpts = Object.assign({}, this._defaultOpts);\n\n    for (const opts of optsList) {\n      if (!opts) continue;\n      Object.keys(newOpts).forEach(key => {\n        if (opts[key] !== undefined) newOpts[key] = opts[key];\n      });\n\n      if (!isInit) {\n        if (opts.nameHint !== undefined) newOpts.nameHint = opts.nameHint;\n        if (opts.blockHoist !== undefined) newOpts.blockHoist = opts.blockHoist;\n      }\n    }\n\n    return newOpts;\n  }\n\n  _generateImport(opts, importName) {\n    const isDefault = importName === \"default\";\n    const isNamed = !!importName && !isDefault;\n    const isNamespace = importName === null;\n    const {\n      importedSource,\n      importedType,\n      importedInterop,\n      importingInterop,\n      ensureLiveReference,\n      ensureNoContext,\n      nameHint,\n      importPosition,\n      blockHoist\n    } = opts;\n    let name = nameHint || importName;\n    const isMod = (0, _isModule.default)(this._programPath);\n    const isModuleForNode = isMod && importingInterop === \"node\";\n    const isModuleForBabel = isMod && importingInterop === \"babel\";\n\n    if (importPosition === \"after\" && !isMod) {\n      throw new Error(`\"importPosition\": \"after\" is only supported in modules`);\n    }\n\n    const builder = new _importBuilder.default(importedSource, this._programScope, this._hub);\n\n    if (importedType === \"es6\") {\n      if (!isModuleForNode && !isModuleForBabel) {\n        throw new Error(\"Cannot import an ES6 module from CommonJS\");\n      }\n\n      builder.import();\n\n      if (isNamespace) {\n        builder.namespace(nameHint || importedSource);\n      } else if (isDefault || isNamed) {\n        builder.named(name, importName);\n      }\n    } else if (importedType !== \"commonjs\") {\n      throw new Error(`Unexpected interopType \"${importedType}\"`);\n    } else if (importedInterop === \"babel\") {\n      if (isModuleForNode) {\n        name = name !== \"default\" ? name : importedSource;\n        const es6Default = `${importedSource}$es6Default`;\n        builder.import();\n\n        if (isNamespace) {\n          builder.default(es6Default).var(name || importedSource).wildcardInterop();\n        } else if (isDefault) {\n          if (ensureLiveReference) {\n            builder.default(es6Default).var(name || importedSource).defaultInterop().read(\"default\");\n          } else {\n            builder.default(es6Default).var(name).defaultInterop().prop(importName);\n          }\n        } else if (isNamed) {\n          builder.default(es6Default).read(importName);\n        }\n      } else if (isModuleForBabel) {\n        builder.import();\n\n        if (isNamespace) {\n          builder.namespace(name || importedSource);\n        } else if (isDefault || isNamed) {\n          builder.named(name, importName);\n        }\n      } else {\n        builder.require();\n\n        if (isNamespace) {\n          builder.var(name || importedSource).wildcardInterop();\n        } else if ((isDefault || isNamed) && ensureLiveReference) {\n          if (isDefault) {\n            name = name !== \"default\" ? name : importedSource;\n            builder.var(name).read(importName);\n            builder.defaultInterop();\n          } else {\n            builder.var(importedSource).read(importName);\n          }\n        } else if (isDefault) {\n          builder.var(name).defaultInterop().prop(importName);\n        } else if (isNamed) {\n          builder.var(name).prop(importName);\n        }\n      }\n    } else if (importedInterop === \"compiled\") {\n      if (isModuleForNode) {\n        builder.import();\n\n        if (isNamespace) {\n          builder.default(name || importedSource);\n        } else if (isDefault || isNamed) {\n          builder.default(importedSource).read(name);\n        }\n      } else if (isModuleForBabel) {\n        builder.import();\n\n        if (isNamespace) {\n          builder.namespace(name || importedSource);\n        } else if (isDefault || isNamed) {\n          builder.named(name, importName);\n        }\n      } else {\n        builder.require();\n\n        if (isNamespace) {\n          builder.var(name || importedSource);\n        } else if (isDefault || isNamed) {\n          if (ensureLiveReference) {\n            builder.var(importedSource).read(name);\n          } else {\n            builder.prop(importName).var(name);\n          }\n        }\n      }\n    } else if (importedInterop === \"uncompiled\") {\n      if (isDefault && ensureLiveReference) {\n        throw new Error(\"No live reference for commonjs default\");\n      }\n\n      if (isModuleForNode) {\n        builder.import();\n\n        if (isNamespace) {\n          builder.default(name || importedSource);\n        } else if (isDefault) {\n          builder.default(name);\n        } else if (isNamed) {\n          builder.default(importedSource).read(name);\n        }\n      } else if (isModuleForBabel) {\n        builder.import();\n\n        if (isNamespace) {\n          builder.default(name || importedSource);\n        } else if (isDefault) {\n          builder.default(name);\n        } else if (isNamed) {\n          builder.named(name, importName);\n        }\n      } else {\n        builder.require();\n\n        if (isNamespace) {\n          builder.var(name || importedSource);\n        } else if (isDefault) {\n          builder.var(name);\n        } else if (isNamed) {\n          if (ensureLiveReference) {\n            builder.var(importedSource).read(name);\n          } else {\n            builder.var(name).prop(importName);\n          }\n        }\n      }\n    } else {\n      throw new Error(`Unknown importedInterop \"${importedInterop}\".`);\n    }\n\n    const {\n      statements,\n      resultName\n    } = builder.done();\n\n    this._insertStatements(statements, importPosition, blockHoist);\n\n    if ((isDefault || isNamed) && ensureNoContext && resultName.type !== \"Identifier\") {\n      return t.sequenceExpression([t.numericLiteral(0), resultName]);\n    }\n\n    return resultName;\n  }\n\n  _insertStatements(statements, importPosition = \"before\", blockHoist = 3) {\n    const body = this._programPath.get(\"body\");\n\n    if (importPosition === \"after\") {\n      for (let i = body.length - 1; i >= 0; i--) {\n        if (body[i].isImportDeclaration()) {\n          body[i].insertAfter(statements);\n          return;\n        }\n      }\n    } else {\n      statements.forEach(node => {\n        node._blockHoist = blockHoist;\n      });\n      const targetPath = body.find(p => {\n        const val = p.node._blockHoist;\n        return Number.isFinite(val) && val < 4;\n      });\n\n      if (targetPath) {\n        targetPath.insertBefore(statements);\n        return;\n      }\n    }\n\n    this._programPath.unshiftContainer(\"body\", statements);\n  }\n\n}\n\nexports.default = ImportInjector;"]},"metadata":{},"sourceType":"script"}